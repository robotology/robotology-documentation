<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iCub-main: velocityObserver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">iCub-main
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">velocityObserver<div class="ingroups"><a class="el" href="group__icub__modules__all.html">Software</a> &raquo; <a class="el" href="group__icub__module.html">iCub modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Estimates the first and second derivatives of incoming data vector through a least-squares algorithm based on an adpative window.  
</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for velocityObserver:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__velocityObserver.png" border="0" usemap="#agroup____velocityObserver" alt=""/></div>
<map name="agroup____velocityObserver" id="agroup____velocityObserver">
<area shape="rect" title="Estimates the first and second derivatives of incoming data vector through a least&#45;squares algorithm ..." alt="" coords="164,5,297,31"/>
<area shape="rect" href="group__icub__module.html" title="This is the list of iCub modules, i.e." alt="" coords="5,5,116,31"/>
</map>
</div>
<p>Estimates the first and second derivatives of incoming data vector through a least-squares algorithm based on an adpative window. </p>
<p>Copyright (C) 2010 RobotCub Consortium</p>
<p>Author: Ugo Pattacini</p>
<p>Date: first release 24/10/2008</p>
<p>CopyPolicy: Released under the terms of the GNU GPL v2.0.</p>
<h1><a class="anchor" id="intro_sec"></a>
Description</h1>
<p>This module computes the first derivative (velocity) and the second derivative (acceleration) of vector acquired through an input YARP port and provides them to output YARP ports. The estimation is performed relying on a least-squares algorithm (<a href="http://ieeexplore.ieee.org/iel5/87/19047/00880606.pdf">PDF</a>) which finds the best linear or quadratic regressor upon a certain window of the input samples. The window's length is adaptable, i.e. it varies according the smoothness of the input signal. Therefore, the smoother is the input signal the larger will be the window and the delay introduced by the computation will be negligible. For fast change in the input signal, the window's length is reduced in order to best capture the derivative and to limit the latency.</p>
<p>Note that no knowledge of the sampling time is required since to perform the computation the module relies on the time information stored by the sender within the envelope of the message. If the envelope is not available, then the Time Stamp is the reference time of the machine where the module is running (i.e. the arrival time): of course in this case the computation will be much less precise due to the variable YARP communication latencies.</p>
<p>The figure below shows a snapshot of the estimated velocity and acceleration along with a comparison between the proposed algorithm and a simple moving average filter: </p><div class="image">
<img src="velocityObserver.jpg" alt=""/>
</div>
<h1><a class="anchor" id="lib_sec"></a>
Libraries</h1>
<ul>
<li>YARP libraries.</li>
<li>ctrlLib library.</li>
</ul>
<h1><a class="anchor" id="parameters_sec"></a>
Parameters</h1>
<p>&ndash;name <em>name</em> </p><ul>
<li>The parameter <em>name</em> identifies the module's name; all the open ports will be tagged with the prefix &lt;name&gt;/. If not specified <em>/velObs</em> is assumed.</li>
</ul>
<p>&ndash;lenVel <em>N</em> </p><ul>
<li>The parameter <em>N</em> identifies the maximum window length for buffering the input data (used for the first derivative estimation). Therefore, the window on which the least-squares algorithm operates on will automatically adapts its length from a minimum of 2 to a maximum of N samples. The greater is N, the more filtered is the derivative.</li>
</ul>
<p>&ndash;lenAcc <em>N</em> </p><ul>
<li>The same as above but for the second derivative's estimation.</li>
</ul>
<p>&ndash;thrVel <em>D</em> </p><ul>
<li>With this option it is possibile to specify the maximum deviation threshold for the algorithm (used for the first derivative estimation). During the validation phase, indeed, the window's length is considered valid if all the computed values from the linear regressor lie within this threshold wrt their corresponding sample values. If not the window's length is reduced by one step. Each instance of the computation a trial on a window's length enlarged by one step wrt to the current one is performed. Therefore, iteration by iteration, the window's length can be adapted by only one step change.</li>
</ul>
<p>&ndash;thrAcc <em>D</em> </p><ul>
<li>The same as above but for the second derivative's estimation.</li>
</ul>
<h1><a class="anchor" id="portsa_sec"></a>
Ports Accessed</h1>
<p>The port the service is listening to.</p>
<h1><a class="anchor" id="portsc_sec"></a>
Ports Created</h1>
<ul>
<li><em></em> &lt;name&gt;/pos:i (e.g. /velObs/pos:i) receives the input data vector.</li>
<li><em></em> &lt;name&gt;/vel:o (e.g. /velObs/vel:o) provides the estimated first derivatives.</li>
<li><em></em> &lt;name&gt;/acc:o (e.g. /velObs/acc:o) provides the estimated second derivatives.</li>
<li><em></em> &lt;name&gt;/rpc remote procedure call port useful to shut down the module remotely by sending to this port the 'quit' command.</li>
</ul>
<h1><a class="anchor" id="in_files_sec"></a>
Input Data Files</h1>
<p>None.</p>
<h1><a class="anchor" id="out_data_sec"></a>
Output Data Files</h1>
<p>None.</p>
<h1><a class="anchor" id="conf_file_sec"></a>
Configuration Files</h1>
<p>None.</p>
<h1><a class="anchor" id="tested_os_sec"></a>
Tested OS</h1>
<p>Linux and Windows.</p>
<h1><a class="anchor" id="example_sec"></a>
Example Instantiation of the Module</h1>
<p>By launching the following command:</p>
<div class="fragment"><div class="line">velocityObserver --name /jointVel --lenVel 20 --thrVel 2.0 </div>
</div><!-- fragment --><p>the module will create the listening port /jointVel/pos:i for the acquisition of data vector coming for instance from one of the icub ports. At the same time it will provide the estimated derivatives to /jointVel/vel:o /jointVel/acc:o ports. Here a value of 20 samples is chosen for the velocity maximum window's length and the velocity maximum permitted tolerance is 2.0; for the acceleration default values are used (use &ndash;help option to see).</p>
<p>Try now the following:</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceyarp.html">yarp</a> connect /icub/right_arm/<a class="code" href="WholeBodyPlayerModule_8h.html#a055865842672bfeb446ff98a1e9104ab">state</a>:o /jointVel/pos:i</div>
<div class="ttc" id="aWholeBodyPlayerModule_8h_html_a055865842672bfeb446ff98a1e9104ab"><div class="ttname"><a href="WholeBodyPlayerModule_8h.html#a055865842672bfeb446ff98a1e9104ab">state</a></div><div class="ttdeci">state</div><div class="ttdef"><b>Definition:</b> <a href="WholeBodyPlayerModule_8h_source.html#l00064">WholeBodyPlayerModule.h:64</a></div></div>
<div class="ttc" id="anamespaceyarp_html"><div class="ttname"><a href="namespaceyarp.html">yarp</a></div><div class="ttdoc">Copyright (C) 2008 RobotCub Consortium.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInterfaces_8h_source.html#l00051">DebugInterfaces.h:51</a></div></div>
</div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Ugo Pattacini </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 26 2024 16:02:19 for iCub-main by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
