<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iCub-main: Using Motor Control Interfaces in Python</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">iCub-main
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using Motor Control Interfaces in Python </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_goal"></a>
Goal</h1>
<p>This tutorial shows how to use Python to interface with the <a class="el" href="namespaceiCub.html" title="This file contains the definition of unique IDs for the body parts and the skin parts of the robot.">iCub</a>. In particular we focus on controlling the motors using the motor control interfaces. We assume that you have already compiled or installed the Python bingings. This tutorial assume basic knowledge of how YARP works in C++. We just show how the robot C++ interface can be used in Python.</p>
<p>Dislaimer: this code does not do anything fancy with the robot. We let you have fun with the robot and Python once you know how the interface works.</p>
<h1><a class="anchor" id="sec_python-ll"></a>
Joint level motor control</h1>
<p>For this tutorial we only need the yarp python bindings.</p>
<p>First initialize yarp.</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> <a class="code" href="namespaceyarp.html">yarp</a>;</div>
<div class="line"><a class="code" href="namespaceyarp.html">yarp</a>.Network.init();</div>
<div class="ttc" id="anamespaceyarp_html"><div class="ttname"><a href="namespaceyarp.html">yarp</a></div><div class="ttdoc">Copyright (C) 2008 RobotCub Consortium.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInterfaces_8h_source.html#l00051">DebugInterfaces.h:51</a></div></div>
</div><!-- fragment --><p>We know initialize a remote_controlboard object connected to the right_arm.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># prepare a property object</span></div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a1919ccc3734ab09b8e6a15d819df565b">props</a> = <a class="code" href="namespaceyarp.html">yarp</a>.Property()</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a1919ccc3734ab09b8e6a15d819df565b">props</a>.put(<span class="stringliteral">&quot;device&quot;</span>,<span class="stringliteral">&quot;remote_controlboard&quot;</span>)</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a1919ccc3734ab09b8e6a15d819df565b">props</a>.put(<span class="stringliteral">&quot;local&quot;</span>,<span class="stringliteral">&quot;/client/right_arm&quot;</span>)</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a1919ccc3734ab09b8e6a15d819df565b">props</a>.put(<span class="stringliteral">&quot;remote&quot;</span>,<span class="stringliteral">&quot;/icubSim/right_arm&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># create remote driver</span></div>
<div class="line"><span class="preprocessor">armDriver = yarp.PolyDriver(props)</span></div>
<div class="ttc" id="anamespacepython-motor-control_html_a1919ccc3734ab09b8e6a15d819df565b"><div class="ttname"><a href="namespacepython-motor-control.html#a1919ccc3734ab09b8e6a15d819df565b">python-motor-control.props</a></div><div class="ttdeci">props</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00017">python-motor-control.py:17</a></div></div>
</div><!-- fragment --><p>Now we can query the motor interfaces.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#query motor control interfaces</span></div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a58ae1d0a5b13a0a368838e8ced2c3289">iPos</a> = <a class="code" href="namespacepython-motor-control.html#a27a4e13b7da2a48a14d19a33a7e4900e">armDriver</a>.viewIPositionControl()</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a0bc1ca4256808f6e3f6cb8b043040332">iEnc</a> = <a class="code" href="namespacepython-motor-control.html#a27a4e13b7da2a48a14d19a33a7e4900e">armDriver</a>.viewIEncoders()</div>
<div class="ttc" id="anamespacepython-motor-control_html_a0bc1ca4256808f6e3f6cb8b043040332"><div class="ttname"><a href="namespacepython-motor-control.html#a0bc1ca4256808f6e3f6cb8b043040332">python-motor-control.iEnc</a></div><div class="ttdeci">iEnc</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00028">python-motor-control.py:28</a></div></div>
<div class="ttc" id="anamespacepython-motor-control_html_a27a4e13b7da2a48a14d19a33a7e4900e"><div class="ttname"><a href="namespacepython-motor-control.html#a27a4e13b7da2a48a14d19a33a7e4900e">python-motor-control.armDriver</a></div><div class="ttdeci">armDriver</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00023">python-motor-control.py:23</a></div></div>
<div class="ttc" id="anamespacepython-motor-control_html_a58ae1d0a5b13a0a368838e8ced2c3289"><div class="ttname"><a href="namespacepython-motor-control.html#a58ae1d0a5b13a0a368838e8ced2c3289">python-motor-control.iPos</a></div><div class="ttdeci">iPos</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00026">python-motor-control.py:26</a></div></div>
</div><!-- fragment --><p>We are now ready to retrive the number of joints, create vectors to store the position commands and move the arm.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#retrieve number of joints</span></div>
<div class="line"><a class="code" href="icub-main_2src_2tools_2simpleClient_2main_8cpp.html#aac40ef34e7573177f3e908c5195594a6">jnts</a>=<a class="code" href="namespacepython-motor-control.html#a58ae1d0a5b13a0a368838e8ced2c3289">iPos</a>.getAxes()</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceeth_1_1parser.html#ac2f5662a765ffbe9a0790ca81c24a838">print</a> <span class="stringliteral">&#39;Controlling&#39;</span>, <a class="code" href="icub-main_2src_2tools_2simpleClient_2main_8cpp.html#aac40ef34e7573177f3e908c5195594a6">jnts</a>, <span class="stringliteral">&#39;joints&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># read encoders</span></div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#aa4a312653eff9f950af80bbf61a3d925">encs</a>=<a class="code" href="namespaceyarp.html">yarp</a>.Vector(<a class="code" href="icub-main_2src_2tools_2simpleClient_2main_8cpp.html#aac40ef34e7573177f3e908c5195594a6">jnts</a>)</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#a0bc1ca4256808f6e3f6cb8b043040332">iEnc</a>.getEncoders(<a class="code" href="namespacepython-motor-control.html#aa4a312653eff9f950af80bbf61a3d925">encs</a>.data())</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># store as home position</span></div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#ae457f2d5a66ef7a457909b6fd2f9fec3">home</a>=<a class="code" href="namespaceyarp.html">yarp</a>.Vector(<a class="code" href="icub-main_2src_2tools_2simpleClient_2main_8cpp.html#aac40ef34e7573177f3e908c5195594a6">jnts</a>, <a class="code" href="namespacepython-motor-control.html#aa4a312653eff9f950af80bbf61a3d925">encs</a>.data())</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#initialize a new tmp vector identical to encs</span></div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>=<a class="code" href="namespaceyarp.html">yarp</a>.Vector(<a class="code" href="icub-main_2src_2tools_2simpleClient_2main_8cpp.html#aac40ef34e7573177f3e908c5195594a6">jnts</a>)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># add 10 degrees to the first four joints</span></div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.set(0, <a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.get(0)+10)</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.set(1, <a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.get(1)+10)</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.set(2, <a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.get(2)+10)</div>
<div class="line"><a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.set(3, <a class="code" href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">tmp</a>.get(3)+10)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># move to new position</span></div>
<div class="line"><span class="preprocessor">iPos.positionMove(tmp.data())</span></div>
<div class="ttc" id="aicub-main_2src_2tools_2simpleClient_2main_8cpp_html_aac40ef34e7573177f3e908c5195594a6"><div class="ttname"><a href="icub-main_2src_2tools_2simpleClient_2main_8cpp.html#aac40ef34e7573177f3e908c5195594a6">jnts</a></div><div class="ttdeci">int jnts</div><div class="ttdef"><b>Definition:</b> <a href="icub-main_2src_2tools_2simpleClient_2main_8cpp_source.html#l00060">main.cpp:60</a></div></div>
<div class="ttc" id="anamespaceeth_1_1parser_html_ac2f5662a765ffbe9a0790ca81c24a838"><div class="ttname"><a href="namespaceeth_1_1parser.html#ac2f5662a765ffbe9a0790ca81c24a838">eth::parser::print</a></div><div class="ttdeci">bool print(const pc104Data &amp;pc104data)</div><div class="ttdef"><b>Definition:</b> <a href="ethParser_8cpp_source.html#l00057">ethParser.cpp:57</a></div></div>
<div class="ttc" id="anamespacepython-motor-control_html_aa48897549d21fee7c0824a33753804e2"><div class="ttname"><a href="namespacepython-motor-control.html#aa48897549d21fee7c0824a33753804e2">python-motor-control.tmp</a></div><div class="ttdeci">tmp</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00043">python-motor-control.py:43</a></div></div>
<div class="ttc" id="anamespacepython-motor-control_html_aa4a312653eff9f950af80bbf61a3d925"><div class="ttname"><a href="namespacepython-motor-control.html#aa4a312653eff9f950af80bbf61a3d925">python-motor-control.encs</a></div><div class="ttdeci">encs</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00036">python-motor-control.py:36</a></div></div>
<div class="ttc" id="anamespacepython-motor-control_html_ae457f2d5a66ef7a457909b6fd2f9fec3"><div class="ttname"><a href="namespacepython-motor-control.html#ae457f2d5a66ef7a457909b6fd2f9fec3">python-motor-control.home</a></div><div class="ttdeci">home</div><div class="ttdoc">store as home position</div><div class="ttdef"><b>Definition:</b> <a href="python-motor-control_8py_source.html#l00040">python-motor-control.py:40</a></div></div>
</div><!-- fragment --><p>Now wait some time and go back to home position:</p>
<div class="fragment"><div class="line"><a class="code" href="namespacepython-motor-control.html#a58ae1d0a5b13a0a368838e8ced2c3289">iPos</a>.positionMove(<a class="code" href="namespacepython-motor-control.html#ae457f2d5a66ef7a457909b6fd2f9fec3">home</a>.data())</div>
</div><!-- fragment --><p>Code can be found at <a class="el" href="python-motor-control_8py.html">python/python-motor-control.py</a></p>
<p>This file can be edited at <a class="el" href="python-motor-control_8dox.html">doc/python-motor-control.dox</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 26 2024 16:02:19 for iCub-main by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
