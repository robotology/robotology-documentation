\hypertarget{group__iKinGazeCtrl}{}\doxysection{i\+Kin\+Gaze\+Ctrl}
\label{group__iKinGazeCtrl}\index{iKinGazeCtrl@{iKinGazeCtrl}}


Gaze controller based on i\+Kin.  


Collaboration diagram for i\+Kin\+Gaze\+Ctrl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{group__iKinGazeCtrl}
\end{center}
\end{figure}
Gaze controller based on i\+Kin. 

Copyright (C) 2010 Robot\+Cub Consortium

Authors\+: Ugo Pattacini, Alessandro Roncone

Copy\+Policy\+: Released under the terms of the GNU GPL v2.\+0.\hypertarget{group__tutorial__perceptiveModels_intro_sec}{}\doxysubsection{Description}\label{group__tutorial__perceptiveModels_intro_sec}
This module provides a controller for the \mbox{\hyperlink{namespaceiCub}{i\+Cub}} gaze capable of steering the neck and the eyes independently performing saccades, pursuit, vergence, OCR (oculo-\/collic reflex) and VOR (vestibulo-\/ocular reflex relying on inertial data).

The controller can be seen as cartesian gaze controller since it receives as input a 3D position in the task space. Nonetheless, further command modalities are available\+: 1) the coordinates (u,v) of just one pixel in the image plane along with a guessed component z in the eye\textquotesingle{}s reference frame can be provided, or alternatively the vergence angle; 2) the position of the target within the two image planes can be converted in the 3D task space using the monocular approach coupled with a pid on the component z; 3) the head-\/centered azimuth and elevation angles along with the vergence angle can be given to the module both in absolute and relative mode.

Moreover, this module also implements the server part of the \href{http://wiki.icub.org/yarpdoc/classyarp_1_1dev_1_1IGazeControl.html}{\texttt{ Gaze Control Interface}}. For a tutorial on how to use the interface, please go \mbox{\hyperlink{icub_gaze_interface}{here}}.

\begin{DoxyNote}{Note}
If the torso is not detected alive then the module will try to keep on working with just the head part.

{\bfseries{If you\textquotesingle{}re going to use this controller for your work, please quote it within any resulting publication}}\+: Roncone A., Pattacini U., Metta G. \& Natale L., \char`\"{}\+A Cartesian 6-\/\+Do\+F Gaze Controller for Humanoid Robots\char`\"{}, {\itshape Proceedings of Robotics\+: Science and Systems}, Ann Arbor, MI, June 18-\/22, 2016.
\end{DoxyNote}
{\bfseries{Reminder}} ~\newline
If you experience a slow speed motion, please check the shift factors settings within your low-\/level configuration file of the head part\+: they should be properly tuned. Usually a value of 8 is enough.

Rule\+: a lower shift factor allows to yield an higher joint speed and at the same time it increases the value of minimum speed that can be executed.

Example\+: look in the file {\itshape icub\+\_\+head\+\_\+torso.\+ini} of your robot setup; you should find something similar to\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{[VELOCITY]}
\DoxyCodeLine{Shifts 8 8 8 8 8 8 ...}

\end{DoxyCode}


Read more on \href{http://wiki.icub.org/wiki/ControlBoard_configuration_file\#Shifts}{\texttt{ Shifts Factors}}.

\begin{DoxyNote}{Note}
A video on \mbox{\hyperlink{namespaceiCub}{i\+Cub}} gazing can be seen \href{https://youtu.be/I4ZKfAvs1y0}{\texttt{ here}}.
\end{DoxyNote}
\hypertarget{group__tutorial__perceptiveModels_lib_sec}{}\doxysubsection{Libraries}\label{group__tutorial__perceptiveModels_lib_sec}

\begin{DoxyItemize}
\item YARP libraries.
\item \mbox{\hyperlink{group__iKin}{i\+Kin}} library (it requires IPOPT lib\+: see the \href{http://wiki.icub.org/wiki/Installing_IPOPT}{\texttt{ wiki}}).
\end{DoxyItemize}\hypertarget{group__tutorial__perceptiveModels_parameters_sec}{}\doxysubsection{Parameters}\label{group__tutorial__perceptiveModels_parameters_sec}
--context {\itshape dir} 
\begin{DoxyItemize}
\item Resource finder default searching directory for configuration files; if not specified, {\itshape i\+Kin\+Gaze\+Ctrl} is assumed. Beware of the \href{http://www.yarp.it/yarp_data_dirs.html}{\texttt{ context search policy}}.
\end{DoxyItemize}

--from {\itshape file} 
\begin{DoxyItemize}
\item Resource finder default configuration file; if not specified, {\itshape config.\+ini} is assumed.
\end{DoxyItemize}

--name {\itshape ctrl\+Name} 
\begin{DoxyItemize}
\item The parameter {\itshape ctrl\+Name} identifies the controller\textquotesingle{}s name; all the open ports will be tagged with the prefix /$<$ctrl\+Name$>$. If not specified, {\itshape i\+Kin\+Gaze\+Ctrl} is assumed.
\end{DoxyItemize}

--robot {\itshape name} 
\begin{DoxyItemize}
\item The parameter {\itshape name} selects the robot name to connect to; if not specified, {\itshape icub} is assumed.
\end{DoxyItemize}

--head {\itshape name} 
\begin{DoxyItemize}
\item The parameter {\itshape name} selects the robot\textquotesingle{}s head port to connect to; if not specified, {\itshape head} is assumed.
\end{DoxyItemize}

--torso {\itshape name} 
\begin{DoxyItemize}
\item The parameter {\itshape name} selects the robot\textquotesingle{}s torso port to connect to; if not specified, {\itshape torso} is assumed. The special string {\itshape off} can be used to skip opening the torso device. ~\newline

\end{DoxyItemize}

--trajectory\+\_\+time\+::neck {\itshape time} 
\begin{DoxyItemize}
\item Specify the neck trajectory execution time in point-\/to-\/point movements \mbox{[}expressed in seconds\mbox{]}; by default {\itshape time} is 0.\+75 seconds. (Tneck cannot be set equal or lower than Teyes).
\end{DoxyItemize}

--trajectory\+\_\+time\+::eyes {\itshape time} 
\begin{DoxyItemize}
\item Specify the eyes trajectory execution time in point-\/to-\/point movements \mbox{[}expressed in seconds\mbox{]}; by default {\itshape time} is 0.\+25 seconds.
\end{DoxyItemize}

--cameras\+::context {\itshape dir} 
\begin{DoxyItemize}
\item The parameter {\itshape dir} specifies the context used to locate the cameras parameters file (see below).
\end{DoxyItemize}

--cameras\+::file {\itshape file} 
\begin{DoxyItemize}
\item The parameter {\itshape file} specifies the file name used to read cameras parameters.
\end{DoxyItemize}

--saccades {\itshape switch} 
\begin{DoxyItemize}
\item Enable/disable saccadic movements; the parameter {\itshape switch} can be therefore \mbox{[}\char`\"{}on\char`\"{}$\vert$\char`\"{}off\char`\"{}\mbox{]}, being \char`\"{}on\char`\"{} by default.
\end{DoxyItemize}

--neck\+\_\+position\+\_\+control {\itshape switch} 
\begin{DoxyItemize}
\item Enable/disable low-\/level position control of the neck; the parameter {\itshape switch} can be therefore \mbox{[}\char`\"{}on\char`\"{}$\vert$\char`\"{}off\char`\"{}\mbox{]}, being \char`\"{}on\char`\"{} by default.
\end{DoxyItemize}

--imu\+::mode {\itshape switch} 
\begin{DoxyItemize}
\item Enable/disable stabilization using IMU data; the parameter {\itshape switch} can be therefore \mbox{[}\char`\"{}on\char`\"{}$\vert$\char`\"{}off\char`\"{}\mbox{]}, being \char`\"{}on\char`\"{} by default.
\end{DoxyItemize}

--imu\+::source\+\_\+port\+\_\+name {\itshape name} 
\begin{DoxyItemize}
\item Allow specifying a different source port for the IMU data (see IMU filtering tools such as e.\+g. imu\+Filter).
\end{DoxyItemize}

--imu\+::stabilization\+\_\+gain {\itshape gain} 
\begin{DoxyItemize}
\item Specify the integral gain (in \mbox{[}1/s\mbox{]}) used for gaze stabilization; the {\itshape gain} is 11.\+0 \mbox{[}1/s\mbox{]} by default.
\end{DoxyItemize}

--imu\+::gyro\+\_\+noise\+\_\+threshold {\itshape thres} 
\begin{DoxyItemize}
\item Specify a different threshold {\itshape thres} given in \mbox{[}deg/s\mbox{]} to filter out the residual bias in gyro readouts.
\end{DoxyItemize}

--imu\+::vor {\itshape gain} 
\begin{DoxyItemize}
\item Specify the contribution of the vestibulo-\/ocular reflex (VOR) in computing the final counter-\/rotation of the eyes due to neck rotation. To turn off the VOR just set the {\itshape gain} equal to 0.\+0. By default {\itshape gain} is 1.\+0, that means {\itshape \char`\"{}full   contribution\char`\"{}}. If {\itshape imu\+::mode} is \char`\"{}off\char`\"{}, then the gain is 0.\+0 by default. Values of the gain greater than 1.\+0 mean {\itshape \char`\"{}contribution amplified\char`\"{}}. --imu\+::timeout
\item Specify the read timeout (in seconds) for the imu data. The default is 0.\+04 seconds.
\end{DoxyItemize}

--ocr {\itshape gain} 
\begin{DoxyItemize}
\item Specify the contribution of the oculo-\/collic reflex (OCR) in computing the counter-\/rotation of the eyes due to neck rotation. To turn off the OCR just set the {\itshape gain} equal to 0.\+0. Default values are 0.\+0 if {\itshape imu\+::mode} is \char`\"{}off\char`\"{}, 1.\+0 otherwise.
\end{DoxyItemize}

--ping\+\_\+robot\+\_\+tmo {\itshape tmo} 
\begin{DoxyItemize}
\item The parameter {\itshape tmo} is the timeout (in seconds) that allows starting up the robot before connecting to it; by default we have a timeout of 40.\+0 \mbox{[}s\mbox{]}.
\end{DoxyItemize}

--eye\+\_\+tilt\+::min {\itshape min} 
\begin{DoxyItemize}
\item The parameter {\itshape min} specifies the minimum eye tilt angle \mbox{[}deg\mbox{]} in order to prevent the eye from being covered by the eyelid (when they\textquotesingle{}re wide open) while moving; default value is -\/12 \mbox{[}deg\mbox{]}.
\end{DoxyItemize}

--eye\+\_\+tilt\+::max {\itshape max} 
\begin{DoxyItemize}
\item The parameter {\itshape max} specifies the maximum eye tilt angle \mbox{[}deg\mbox{]} in order to prevent the eye from being covered by the eyelid (when they\textquotesingle{}re wide open) while moving; default value is 15 \mbox{[}deg\mbox{]}.
\end{DoxyItemize}

--min\+\_\+abs\+\_\+vel {\itshape vel} 
\begin{DoxyItemize}
\item The parameter {\itshape vel} specifies the minimum absolute velocity that can be achieved by the robot \mbox{[}deg/s\mbox{]} due to the approximation performed while delivering data over the network. By default this value is 0.\+0 having no result on the controller\textquotesingle{}s operations. In case it is different from 0.\+0, the controller will implement a bang-\/bang approach whenever the velocity to be delivered goes under the minimum threshold.
\end{DoxyItemize}

--head\+\_\+version {\itshape ver} 
\begin{DoxyItemize}
\item This option specifies the kinematic structure of the head; the value {\itshape ver} is a string (e.\+g., \char`\"{}v1.\+0\char`\"{}, \char`\"{}v2.\+0\char`\"{}), being \char`\"{}v1.\+0\char`\"{} the default.
\end{DoxyItemize}

--verbose
\begin{DoxyItemize}
\item Enable some output print-\/out.
\end{DoxyItemize}

--tweak\+::file {\itshape file} 
\begin{DoxyItemize}
\item The parameter {\itshape file} specifies the file name (located in module context) used to read/write options that are tweakable by the user; if not provided, {\itshape tweak.\+ini} is assumed.
\end{DoxyItemize}

--tweak\+::overwrite {\itshape switch} 
\begin{DoxyItemize}
\item If \char`\"{}on\char`\"{}, at startup default values and cameras values retrieved from file will be overwritten by those values contained in the tweak file. The {\itshape switch} is \char`\"{}on\char`\"{} by default.
\end{DoxyItemize}\hypertarget{group__tutorial__ationPrimitives_portsa_sec}{}\doxysubsection{Ports Accessed}\label{group__tutorial__ationPrimitives_portsa_sec}
The ports the module is connected to\+: e.\+g. /icub/head/command\+:i and so on.\hypertarget{group__tutorial__ationPrimitives_portsc_sec}{}\doxysubsection{Ports Created}\label{group__tutorial__ationPrimitives_portsc_sec}
There are different ways of commanding a new target fixation point\+:


\begin{DoxyItemize}
\item by sending the absolute 3D position to gaze at in the task space through /$<$ctrl\+Name$>$/xd\+:i port.
\item by localizing the target in just one image plane and then sending its coordinates together with a guessed component z in the eye\textquotesingle{}s reference frame to the /$<$ctrl\+Name$>$/mono\+:i port. Alternatively, the z component can be replaced by the vergence angle. {\bfseries{In this mode the cameras intrinsic parameters are required}}.
\item by localizing the target in the two image planes and thus sending its coordinates to the /$<$ctrl\+Name$>$/stereo\+:i port. This strategy employs the monocular approach along with a pid that varies the component z incrementally according to the actual error; to achieve that it\textquotesingle{}s required to feed continuosly the port with new feedback while converging to the target. {\bfseries{In this mode the cameras intrinsic parameters are required}}.
\item by sending the head-\/centered azimuth/elevation couple in degrees wrt either to the current head position or to the absolute head position (computed with the robot looking straight ahead and all neck and eyes encoders zeroed). Vergence is also to be given either in relative mode or absolute mode. ~\newline
 In this mode a final conversion to 3D points is always performed wrt to the absolute head position since the controller is intrinsically cartesian. Moreover, as the center of the head varies over time because of the motion induced by the neck, the ultimate target vergence given for instance as delta wrt the current one may differ from what expected beacuse what is actually achieved is the corresponding 3D point.
\end{DoxyItemize}

The module creates the usual ports required for the communication with the robot (through interfaces) and the following ports\+:


\begin{DoxyItemize}
\item {\itshape /} $<$ctrl\+Name$>$/xd\+:i receives the target fixation point. It accepts 3 double (also as a Bottle object) for xyz coordinates.
\item {\itshape /} $<$ctrl\+Name$>$/mono\+:i receives the current target position expressed in one image plane. The input data format is the Bottle \mbox{[}type u v z\mbox{]}, where {\itshape type} can be \char`\"{}left\char`\"{} or \char`\"{}right\char`\"{}, {\itshape  (u,v) } is the pixel coordinates and {\itshape z} is the guessed z-\/component in the eye\textquotesingle{}s reference frame. An alternative command modality employs the vergence given in degrees in place of the z-\/component and its format is\+: \mbox{[}type u v \char`\"{}ver\char`\"{} ver\mbox{]}.
\item {\itshape /} $<$ctrl\+Name$>$/stereo\+:i receives the current target position expressed in image planes. It accepts 4 double (also as a Bottle object) in this order\+: \mbox{[}ul vl ur vr\mbox{]}.
\item {\itshape /} $<$ctrl\+Name$>$/angles\+:i receives the current target position expressed as azimuth/elevation/vergence triplet in degrees. It accepts 1 string and 3 doubles (also as a Bottle object) in this order\+: \mbox{[}mode azi ele ver\mbox{]}, where {\itshape mode} can be {\itshape rel} or {\itshape abs}. A positive azimuth will turn the gaze to the right, whereas a positive elevation will move the gaze upward.
\item {\itshape /} $<$ctrl\+Name$>$/x\+:o returns the actual fixation point (Vector of 3 double). Units in meters.
\item {\itshape /} $<$ctrl\+Name$>$/q\+:o returns the actual joints configuration during movement (Vector of 9 double). The order for torso angles is the one defined by kinematic chain. Units in degrees.
\item {\itshape /} $<$ctrl\+Name$>$/angles\+:o returns the current azimuth/elevation couple wrt to the absolute head position, together with the current vergence (Vector of 3 double). Units in degrees.
\item {\itshape /} $<$ctrl\+Name$>$/events\+:o streams out the event associated to the controller\textquotesingle{}s state. ~\newline
 Available events are\+:
\begin{DoxyItemize}
\item \char`\"{}motion-\/onset\char`\"{} $<$time$>$\+: sent out at the beginning of the motion; comprise the time instant of the source when the event took place.
\item \char`\"{}motion-\/done\char`\"{} $<$time$>$\+: sent out at the end of the motion; comprise the time instant of the source when the event took place.
\item \char`\"{}motion-\/ongoing\char`\"{} $<$time$>$ $<$checkpoint$>$\+: sent out when the portion of path given in \mbox{[}0,1\mbox{]} by the checkpoint parameter has been attained; comprise the time instant of the source when the event took place as well as the checkpoint.
\item \char`\"{}saccade-\/onset\char`\"{} $<$time$>$\+: sent out at the beginning of the saccade; comprise the time instant of the source when the event took place.
\item \char`\"{}saccade-\/done\char`\"{} $<$time$>$\+: sent out at the end of the saccade; comprise the time instant of the source when the event took place.
\item \char`\"{}stabilization-\/on\char`\"{} $<$time$>$\+: notify that gaze stabilization has been turned on; comprise the time instant of the source when the event took place.
\item \char`\"{}stabilization-\/off\char`\"{} $<$time$>$\+: notify that gaze stabilization has been turned off; comprise the time instant of the source when the event took place.
\item \char`\"{}closing\char`\"{} $<$time$>$\+: sent out when the controller is being shut down; comprise the time instant of the source when the event took place.
\item \char`\"{}suspended\char`\"{} $<$time$>$\+: sent out when the controller is suspended; comprise the time instant of the source when the event took place.
\item \char`\"{}resumed\char`\"{} $<$time$>$\+: sent out when the controller is resumed; comprise the time instant of the source when the event took place.
\item \char`\"{}comm-\/timeout\char`\"{} $<$time$>$\+: sent out when the controller gets suspended because of a communication timeout; comprise the time instant of the source when the event took place.
\end{DoxyItemize}
\item {\itshape /} $<$ctrl\+Name$>$/rpc remote procedure call. ~\newline
 Recognized remote commands (be careful, {\bfseries{commands dealing with geometric projections will only work if the cameras intrinsic parameters are provided}})\+:
\begin{DoxyItemize}
\item \mbox{[}stop\mbox{]}\+: stop the motion immediately.
\item \mbox{[}bind\mbox{]} \mbox{[}pitch\mbox{]} $<$min$>$ $<$max$>$\+: bind the neck pitch within a range given in degrees.
\item \mbox{[}bind\mbox{]} \mbox{[}roll\mbox{]} $<$min$>$ $<$max$>$\+: bind the neck roll within a range given in degrees.
\item \mbox{[}bind\mbox{]} \mbox{[}yaw\mbox{]} $<$min$>$ $<$max$>$\+: bind the neck yaw within a range given in degrees.
\item \mbox{[}bind\mbox{]} \mbox{[}eyes\mbox{]} $<$ver$>$\+: bind the eyes to look always straight ahead (the tilt can vary) with a specified vergence given in degrees.
\item \mbox{[}clear\mbox{]} \mbox{[}pitch\mbox{]}\+: restore the neck pitch range.
\item \mbox{[}clear\mbox{]} \mbox{[}roll\mbox{]}\+: restore the neck roll range.
\item \mbox{[}clear\mbox{]} \mbox{[}yaw\mbox{]}\+: restore the neck yaw range.
\item \mbox{[}clear\mbox{]} \mbox{[}eyes\mbox{]}\+: restore the eyes movements.
\item \mbox{[}get\mbox{]} \mbox{[}Tneck\mbox{]}\+: returns the neck movements execution time.
\item \mbox{[}get\mbox{]} \mbox{[}Teyes\mbox{]}\+: returns the eyes movements execution time.
\item \mbox{[}get\mbox{]} \mbox{[}vor\mbox{]}\+: returns the vor gain.
\item \mbox{[}get\mbox{]} \mbox{[}ocr\mbox{]}\+: returns the ocr gain.
\item \mbox{[}get\mbox{]} \mbox{[}sacc\mbox{]}\+: returns the saccades control status \mbox{[}0/1\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}sinh\mbox{]}\+: returns the saccades inhibition period \mbox{[}s\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}sact\mbox{]}\+: returns the saccades activation angle \mbox{[}deg\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}track\mbox{]}\+: returns the current controller\textquotesingle{}s tracking mode \mbox{[}0/1\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}stab\mbox{]}\+: returns 1 iff gaze stabilization is active, 0 otherwise.
\item \mbox{[}get\mbox{]} \mbox{[}done\mbox{]}\+: returns 1 iff motion is done, 0 otherwise.
\item \mbox{[}get\mbox{]} \mbox{[}sdon\mbox{]}\+: returns 1 iff saccade is done, 0 if still underway.
\item \mbox{[}get\mbox{]} \mbox{[}pitch\mbox{]}\+: returns in degrees the current range of neck pitch joint.
\item \mbox{[}get\mbox{]} \mbox{[}roll\mbox{]}\+: returns in degrees the current range of neck roll joint.
\item \mbox{[}get\mbox{]} \mbox{[}yaw\mbox{]}\+: returns in degrees the current range of neck yaw joint.
\item \mbox{[}get\mbox{]} \mbox{[}eyes\mbox{]}\+: returns in degrees the vergence set when eyes are bound to look straight ahead; a negative values means no constraint.
\item \mbox{[}get\mbox{]} \mbox{[}ntol\mbox{]}\+: returns in degrees the current user tolerance for gazing with the neck.
\item \mbox{[}get\mbox{]} \mbox{[}des\mbox{]}\+: returns the desired head joints angles that achieve the target \mbox{[}deg\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}vel\mbox{]}\+: returns the head joints velocities commanded by the controller \mbox{[}deg/s\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}pose\mbox{]} $<$type$>$\+: returns (enclosed in a list) the left eye pose if type==\char`\"{}left\char`\"{}, the right eye pose if type==\char`\"{}right\char`\"{} and the head-\/centered pose if type==\char`\"{}head\char`\"{}. The pose is given in axis/angle representation (i.\+e. 7-\/componenets vector). Additionally, a stamp is appended as further list accounting for the time (second element of the list) relative to the encoders positions used to compute the pose.
\item \mbox{[}get\mbox{]} \mbox{[}2D\mbox{]} ($<$type$>$ $<$x$>$ $<$y$>$ $<$z$>$)\+: returns the 2D pixel point whose cartesian coordinates (x,y,z) are given wrt the root reference frame as the result of its projection into the image plane $<$type$>$ \mbox{[}\char`\"{}left\char`\"{}$\vert$\char`\"{}right\char`\"{}\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}3D\mbox{]} \mbox{[}mono\mbox{]} ($<$type$>$ $<$ u$>$ $<$v$>$ $<$z$>$)\+: returns the 3D point whose projected pixel coordinates (u,v) in the image plane $<$type$>$ \mbox{[}\char`\"{}left\char`\"{}$\vert$\char`\"{}right\char`\"{}\mbox{]} along with third component $<$z$>$ in the eye\textquotesingle{}s reference frame are given.
\item \mbox{[}get\mbox{]} \mbox{[}3D\mbox{]} \mbox{[}stereo\mbox{]} ($<$ ul$>$ $<$vl$>$ $<$ur$>$ $<$vr$>$)\+: returns the 3D point whose projected pixels coordinates (ul,vl) and (ur,vr) in the image planes are provided as the result of the triangulation. \begin{DoxyNote}{Note}
The triangulation is deeply affected by uncertainties in the cameras extrinsic parameters and cameras alignment.
\end{DoxyNote}

\item \mbox{[}get\mbox{]} \mbox{[}3D\mbox{]} \mbox{[}proj\mbox{]} ($<$type$>$ $<$ u$>$ $<$v$>$ $<$ a$>$ $<$ b$>$ $<$ c$>$ $<$d$>$)\+: returns the 3D point with projected pixel coordinates (u,v) in the image plane $<$type$>$ \mbox{[}\char`\"{}left\char`\"{}$\vert$\char`\"{}right\char`\"{}\mbox{]} that results from the intersection with the plane expressed with its implicit equation ax+by+cz+d=0 in the root reference frame.
\item \mbox{[}get\mbox{]} \mbox{[}3D\mbox{]} \mbox{[}ang\mbox{]} ($<$type$>$ $<$azi$>$ $<$ele$>$ $<$ver$>$)\+: transforms angular coordinates into cartesian coordinates. The option $<$type$>$ can be \mbox{[}\char`\"{}abs\char`\"{}$\vert$\char`\"{}rel\char`\"{}\mbox{]}.
\item \mbox{[}get\mbox{]} \mbox{[}ang\mbox{]} ($<$x$>$ $<$y$>$ $<$z$>$)\+: transforms cartesian coordinates into absolute angular coordinates.
\item \mbox{[}get\mbox{]} \mbox{[}pid\mbox{]}\+: returns (enclosed in a list) a property-\/like bottle containing the pid values used to converge to the target with stereo input.
\item \mbox{[}get\mbox{]} \mbox{[}info\mbox{]}\+: returns (enclosed in a list) a property-\/like bottle containing useful information, such as the \char`\"{}head\+\_\+version\char`\"{} (e.\+g. \char`\"{}1.\+0\char`\"{}, \char`\"{}2.\+0\char`\"{}, ...), the \char`\"{}min\+\_\+allowed\+\_\+vergence\char`\"{} (in degrees), a list of the available \char`\"{}events\char`\"{}, the intrinsic and extrinsic camera parameters used.
\item \mbox{[}get\mbox{]} \mbox{[}tweak\mbox{]}\+: returns (enclosed in a list) a property-\/like bottle containing low-\/level information on the current controller\textquotesingle{}s configuration.
\item \mbox{[}set\mbox{]} \mbox{[}Tneck\mbox{]} $<$val$>$\+: sets a new movements execution time for neck movements.
\item \mbox{[}set\mbox{]} \mbox{[}Teyes\mbox{]} $<$val$>$\+: sets a new movements execution time for eyes movements.
\item \mbox{[}set\mbox{]} \mbox{[}vor\mbox{]} $<$val$>$\+: sets a new gain for vor.
\item \mbox{[}set\mbox{]} \mbox{[}ocr\mbox{]} $<$val$>$\+: sets a new gain for ocr.
\item \mbox{[}set\mbox{]} \mbox{[}sacc\mbox{]} $<$val$>$\+: enables/disables saccades; val can be \mbox{[}0/1\mbox{]}.
\item \mbox{[}set\mbox{]} \mbox{[}sinh\mbox{]} $<$val$>$\+: sets the saccades inhibition period \mbox{[}s\mbox{]}.
\item \mbox{[}set\mbox{]} \mbox{[}sact\mbox{]} $<$val$>$\+: sets the saccades activation angle \mbox{[}deg\mbox{]}.
\item \mbox{[}set\mbox{]} \mbox{[}ntol\mbox{]} $<$val$>$\+: sets in degrees the new user tolerance for gazing with the neck.
\item \mbox{[}set\mbox{]} \mbox{[}track\mbox{]} $<$val$>$\+: sets the controller\textquotesingle{}s tracking mode; val can be \mbox{[}0/1\mbox{]}.
\item \mbox{[}set\mbox{]} \mbox{[}stab\mbox{]} $<$val$>$\+: turns on/off the gaze stabilization (if enabled at start-\/up); val can be \mbox{[}0/1\mbox{]}.
\item \mbox{[}set\mbox{]} \href{(prop0 (<val> <val> ...)) (prop1) (<val>
      <val> ...)}{\texttt{ pid}}\+: sets the pid values used to converge to the target with stereo input. The pid is implemented in parallel form (\mbox{\hyperlink{group__PIDs}{PIDs}}). Aside from the usual pid parameters a further option \char`\"{}dominant\+Eye\char`\"{} is available that enables the user to chose the dominant eye employed for the monocular approach.
\item \mbox{[}set\mbox{]} \href{(prop0 (<val> <val> ...)) (prop1) (<val>
      <val> ...)}{\texttt{ tweak}}\+: sets parameters for the low-\/level controller\textquotesingle{}s configuration.
\item \mbox{[}look\mbox{]} \mbox{[}3D\mbox{]} ($<$x$>$ $<$y$>$ $<$z$>$)\+: yields gazing at target specified as 3D point. Distances are in meters.
\item \mbox{[}look\mbox{]} \mbox{[}mono\mbox{]} ($<$type$>$ $<$ u$>$ $<$v$>$ $<$z$>$)\+: yields gazing at target specified in terms of pixel coordinates (u,v) in the image plane $<$type$>$ \mbox{[}\char`\"{}left\char`\"{}$\vert$\char`\"{}right\char`\"{}\mbox{]} along with third component $<$z$>$ in the eye\textquotesingle{}s reference frame. Distances are in meters.
\item \mbox{[}look\mbox{]} \mbox{[}mono\mbox{]} ($<$type$>$ $<$ u$>$ $<$v$>$ \char`\"{}ver\char`\"{} $<$ver$>$)\+: yields gazing at target specified in terms of pixel coordinates (u,v) in the image plane $<$type$>$ \mbox{[}\char`\"{}left\char`\"{}$\vert$\char`\"{}right\char`\"{}\mbox{]} along with the vergence $<$ver$>$. Angles are in degrees.
\item \mbox{[}look\mbox{]} \mbox{[}stereo\mbox{]} ($<$ ul$>$ $<$vl$>$ $<$ur$>$ $<$vr$>$)\+: yields gazing at target specified in terms of projected pixels coordinates (ul,vl) and (ur,vr) in the image planes.
\item \mbox{[}look\mbox{]} \mbox{[}ang\mbox{]} ($<$type$>$ $<$azi$>$ $<$ele$>$ $<$ver$>$)\+: yields gazing at target specified in angular coordinates. The option $<$type$>$ can be \mbox{[}\char`\"{}abs\char`\"{}$\vert$\char`\"{}rel\char`\"{}\mbox{]}. Angles are in degrees.
\item \mbox{[}store\mbox{]}\+: store the controller context returning an integer identifier. The context comprises the values of internal controller variables, such as the tracking mode, the trajectory time and so on.
\item \mbox{[}restore\mbox{]} $<$id$>$\+: restore a previously stored controller context referred by the identifier {\itshape id}.
\item \href{id0> <id1> ...}{\texttt{ del}}\+: delete all the contexts whose ids are contained in the list.
\item \mbox{[}register\mbox{]} \mbox{[}ongoing\mbox{]} $<$checkpoint$>$\+: register the \char`\"{}motion-\/ongoing\char`\"{} event with the given checkpoint in \mbox{[}0,1\mbox{]}.
\item \mbox{[}unregister\mbox{]} \mbox{[}ongoing\mbox{]} $<$checkpoint$>$\+: unregister the \char`\"{}motion-\/ongoing\char`\"{} event with the given checkpoint in \mbox{[}0,1\mbox{]}.
\item \mbox{[}list\mbox{]} \mbox{[}ongoing\mbox{]}\+: return the list of registered \char`\"{}motion-\/ongoing\char`\"{} events.
\item \mbox{[}susp\mbox{]}\+: suspend the module.
\item \mbox{[}run\mbox{]}\+: resume the module.
\item \mbox{[}status\mbox{]}\+: returns \char`\"{}running\char`\"{} or \char`\"{}suspended\char`\"{}.
\item \mbox{[}quit\mbox{]}\+: quit the module.
\end{DoxyItemize}
\end{DoxyItemize}

\begin{DoxyNote}{Note}
When the tracking mode is active and the controller has reached the target, it keeps on sending velocities to the head in order to compensate for any movements induced by the torso. If tracking mode is switched off, the controller automatically disconnects once the target is attained and reconnects at the next requested target. The controller starts by default in non-\/tracking mode.
\end{DoxyNote}
\hypertarget{group__iKinGazeCtrl_coor_sys_sec}{}\doxysubsection{Coordinate System}\label{group__iKinGazeCtrl_coor_sys_sec}
Positions (meters) refer to the root reference frame attached to the waist as in the \href{http://wiki.icub.org/wiki/ICubForwardKinematics}{\texttt{ wiki}}.\hypertarget{group__tutorial__ationPrimitives_in_files_sec}{}\doxysubsection{Input Data Files}\label{group__tutorial__ationPrimitives_in_files_sec}
None.\hypertarget{group__tutorial__ationPrimitives_out_data_sec}{}\doxysubsection{Output Data Files}\label{group__tutorial__ationPrimitives_out_data_sec}
None.\hypertarget{group__tutorial__ationPrimitives_conf_file_sec}{}\doxysubsection{Configuration Files}\label{group__tutorial__ationPrimitives_conf_file_sec}
A configuration file passed through {\itshape --cameras\+::file} contains the fields required to specify the cameras intrinsic parameters along with a roto-\/translation matrix appended to the eye kinematic (see the i\+Kin\+Chain\+::set\+HN method) in order to achieve the alignment with the optical axes compensating for possible unknown offsets.

The final roto-\/translation matrix is meaningful only as result of the calibration of the cameras extrinsic parameters that can be obtained for instance through the \mbox{\hyperlink{group__icub__stereoCalib}{stereo\+Calib}} module.

Example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{[CAMERA\_CALIBRATION\_RIGHT]}
\DoxyCodeLine{fx 225.904}
\DoxyCodeLine{fy 227.041}
\DoxyCodeLine{cx 157.858}
\DoxyCodeLine{cy 113.51}
\DoxyCodeLine{}
\DoxyCodeLine{[CAMERA\_CALIBRATION\_LEFT]}
\DoxyCodeLine{fx 219.057}
\DoxyCodeLine{fy 219.028}
\DoxyCodeLine{cx 174.742}
\DoxyCodeLine{cy 102.874}
\DoxyCodeLine{}
\DoxyCodeLine{[ALIGN\_KIN\_LEFT]}
\DoxyCodeLine{HN (0.0 1.0 2.0 ... 15.0)  \textcolor{comment}{// list of 4x4 doubles (per rows)}}
\DoxyCodeLine{}
\DoxyCodeLine{[ALIGN\_KIN\_RIGHT]}
\DoxyCodeLine{HN (0.0 1.0 2.0 ... 15.0)  \textcolor{comment}{// list of 4x4 doubles (per rows)}}

\end{DoxyCode}
\hypertarget{group__tutorial__perceptiveModels_tested_os_sec}{}\doxysubsection{Tested OS}\label{group__tutorial__perceptiveModels_tested_os_sec}
Windows, Linux

\begin{DoxyAuthor}{Author}
Ugo Pattacini, Alessandro Roncone 
\end{DoxyAuthor}
